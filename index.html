<!DOCTYPE html>
<html lang="en-us">
    <head>
        <title>ben</title>
        <link rel="icon" href="./assets/icon.png" type="image/x-icon">
        <meta property="og:type" content="website">
        <meta property="og:site_name" content="ben-html">
        <meta property="og:title" content="ben.">
        <meta property="og:description" content="yes, no.">
        <meta property="og:image" content="https://github.com/JeremyGamer13/html-ben/blob/main/assets/icon.png?raw=true">
        <style>
            center {
                text-align: center;
            }
            .game {
                /* background-color: dodgerblue; */
                width: 100%;
                height: 100%;
                position: absolute;
                left: 0%;
                top: 0%;
            }
            #ben {
                position: absolute;
                width: 32.5%;
                left: 32.5%;
                top: 0%;
            }
        </style>
    </head>
    <body style="background-color: black;">
        <noscript>
            <br>
            <br>
            <center>
                <img src="./assets/epicfail.png">
            </center>
        </noscript>
        <div id="screen" class="game" style="display: none;">
            <img style="margin-top: 17.5%;margin-left: 1%;width: 20%;" src="./assets/credit.png">
            <button style="position:absolute;left:5%;bottom:3%;width: 20%;height: 10%;" id="resetButton" onclick="resetRecognition()">Click to fix no microphone issue</button>
            <img id="ben" src="./assets/animations/stand.gif">
        </div>
        <script>
            const display = document.getElementById("screen")
            const ben = document.getElementById("ben")
            display.removeAttribute("style")
            let canPlaySound = false
            window.onclick = () => {
                canPlaySound = true
            }
            let recognition = new webkitSpeechRecognition()
            recognition.continuous = true
            recognition.lang = 'en-US'
            recognition.interimResults = false
            recognition.start()
            recognition.onresult = (event) => {
                if (!canPlaySound) {
                    alert("Ben understood you, but you need to click on the page at least once for him to be able to respond!")
                    return
                }
                const speechResult = event.results[event.results.length - 1][0].transcript;
                const minimizedSpeech = String(speechResult).toLowerCase().replaceAll(" ", "")
                const responses = ["yes", "no", "ugh", "hohoho"]
                let response = responses[Math.round(Math.random() * (responses.length - 1))]
                switch (minimizedSpeech) {
                    case 'fard':
                        response = "fard"
                        break;
                    case 'fuckyoupieceofshit':
                    case 'f***youpieceofs***':
                        response = "laugh"
                        break;
                }
                const audio = new Audio('./assets/audio/' + response + '.wav');
                audio.play();
                ben.src = './assets/animations/' + response + '.gif'
                console.log("Ben heard:", speechResult, "\nBen said:", response)
                try {
                    recognition.start()
                } catch {
                    
                }
            }
            document.getElementById("resetButton").onclick = () => {
                let Newrecognition = new webkitSpeechRecognition()
                Newrecognition.continuous = recognition.continuous
                Newrecognition.lang = recognition.lang
                Newrecognition.interimResults = recognition.interimResults
                Newrecognition.onresult = recognition.onresult
                recognition.stop()
                recognition = Newrecognition
                recognition.start()
            }
        </script>
    </body>
</html>